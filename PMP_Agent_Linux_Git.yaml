- name: Install UEMS Linux Agent
  hosts: all
  become: yes
  vars:
    repo_url: "https://github.com/askerchanASL/ansible.git"
    repo_dest: "/tmp/ME"

  tasks:

- name: Copy LinuxAgent file
  ansible.builtin.copy:
    src: "{{ repo_dest }}/LinuxAgent/"
    dest: "{{ repo_dest }}"
    mode: '0644'


    - name: Make UEMS_LinuxAgent.bin executable
      ansible.builtin.file:
        path: "{{ repo_dest }}/UEMS_LinuxAgent.bin"
        mode: '0755'

    - name: Run the installer
      ansible.builtin.command:
        cmd: ./UEMS_LinuxAgent.bin
        chdir: "{{ repo_dest }}"

    - name: Remove Folder
      ansible.builtin.file:
        path: "{{ repo_dest }}"
        state: absent
